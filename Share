Great â€” fresh start is the best way to get this clean and modular! Here's a step-by-step plan for setting up Plotly.js modularly with your Blazor Server (.NET 6) project using your Oracle data:

---

### âœ… 1. **Project Folder Structure Recommendation**
Keep it clean and modular like this:

```
Star/
â”‚
â”œâ”€â”€ Pages/
â”‚   â”œâ”€â”€ Index.razor                # Main landing page (can host charts)
â”‚   â”œâ”€â”€ FeatureUsage.razor         # Example chart page (modular)
â”‚
â”œâ”€â”€ Shared/
â”‚   â””â”€â”€ Charts/
â”‚       â””â”€â”€ PlotlyChart.razor      # Reusable Plotly component
â”‚
â”œâ”€â”€ wwwroot/
â”‚   â””â”€â”€ js/
â”‚       â”œâ”€â”€ plotly/
â”‚       â”‚   â””â”€â”€ plotly.min.js      # From Plotly.js 3.0.1
â”‚       â””â”€â”€ plotlyInterop.js       # Custom JS interop file
â”‚
â”œâ”€â”€ Models/
â”‚   â””â”€â”€ FeatureUsage.cs            # Models for chart data
â”‚
â”œâ”€â”€ Services/
â”‚   â”œâ”€â”€ OracleDataService.cs       # Your existing Oracle fetch logic
â”‚   â””â”€â”€ IOracleDataService.cs
```

---

### âœ… 2. **Add the Interop JS**

ðŸ“ `wwwroot/js/plotlyInterop.js`:

```js
window.renderPlotlyBarChart = (chartId, chartData) => {
    var trace = {
        x: chartData.labels,
        y: chartData.values,
        type: 'bar',
        marker: { color: 'rgba(54, 162, 235, 0.6)' }
    };

    var layout = {
        title: chartData.title,
        xaxis: { title: chartData.xLabel },
        yaxis: { title: chartData.yLabel }
    };

    Plotly.newPlot(chartId, [trace], layout);
};
```

---

### âœ… 3. **Reference JS in `_Layout.cshtml`**

ðŸ“„ `Pages/_Layout.cshtml` (inside `<body>` before `</body>`):

```html
<script src="~/js/plotly/plotly.min.js"></script>
<script src="~/js/plotlyInterop.js"></script>
```

---

### âœ… 4. **Reusable PlotlyChart Component**

ðŸ“„ `Shared/Charts/PlotlyChart.razor`:

```razor
@inject IJSRuntime JSRuntime

<div class="mb-5">
    <h5>@Title</h5>
    <div id="@ChartId" style="width:100%; height:400px;"></div>
</div>

@code {
    [Parameter] public string ChartId { get; set; } = "myPlot";
    [Parameter] public string Title { get; set; } = "";
    [Parameter] public List<string> Labels { get; set; } = new();
    [Parameter] public List<double> Values { get; set; } = new();
    [Parameter] public string XLabel { get; set; } = "";
    [Parameter] public string YLabel { get; set; } = "";

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            var chartData = new
            {
                labels = Labels,
                values = Values,
                title = Title,
                xLabel = XLabel,
                yLabel = YLabel
            };

            await JSRuntime.InvokeVoidAsync("renderPlotlyBarChart", ChartId, chartData);
        }
    }
}
```

---

### âœ… 5. **FeatureUsage Page Example**

ðŸ“„ `Pages/FeatureUsage.razor`:

```razor
@page "/feature-usage"
@inject Star.Services.IOracleDataService DataService

<h3>Feature Usage in Last 30 Days</h3>

@if (IsLoading)
{
    <p>Loading...</p>
}
else if (!string.IsNullOrEmpty(ErrorMessage))
{
    <div class="alert alert-danger">@ErrorMessage</div>
}
else
{
    <PlotlyChart ChartId="featureUsageChart"
                 Title="Feature Usage in Last 30 Days"
                 Labels="Labels"
                 Values="Values"
                 XLabel="Feature"
                 YLabel="Count" />
}

@code {
    private bool IsLoading = true;
    private string? ErrorMessage;
    private List<string> Labels = new();
    private List<double> Values = new();

    protected override async Task OnInitializedAsync()
    {
        try
        {
            var data = await DataService.GetFeatureUsageAsync();
            Labels = data.Select(f => f.Feature).ToList();
            Values = data.Select(f => (double)f.UsageCount).ToList();
        }
        catch (Exception ex)
        {
            ErrorMessage = ex.Message;
        }
        finally
        {
            IsLoading = false;
        }
    }
}
```

---

### âœ… 6. **Register `PlotlyChart` Namespace**

In `_Imports.razor`, add:

```razor
@using Star.Shared.Charts
```

---

Letâ€™s start with this `FeatureUsage` page. Once this is confirmed working, we can build additional charts (next query) in their own pages or components the same way.

Ready to test this setup? Let me know if you'd like a `.razor` + `.js` pack zipped too.
